"use strict";(self.webpackChunkantd_more=self.webpackChunkantd_more||[]).push([[2384],{32384:function(e,t,r){r.d(t,{Z:function(){return ae}});var i=r(25189),n=r.n(i),o=r(73450),l=r.n(o),a=r(6511),s=r(9351),u=r(61840),c=r.n(u),d=r(4464),p=r(4911),f=r(95748),v=r.n(f),m=r(83703),g=r.n(m),x=r(18765),h=r.n(x),w=r(6272),j=r(77307),b=r(93087),U=r.n(b),L=r(37409),y=r(11721),P=r(91698),M=r(73988);function Z(e){if("string"!=typeof e||!e)return"";var t="/";e.indexOf("\\")>-1&&(t="\\");var r=e.split(t);return r[r.length-1]||""}var C={},k=function(e,t,r){return C[e]||(C[e]={}),C[e][t]||(C[e][t]=URL.createObjectURL(r)),C[e][t]},S=r(58909),R=r(49308),T=["imgUrl","style"],O=function(e){var t=e.imgUrl,r=void 0===t?"":t,i=e.style,o=void 0===i?{}:i,a=l()(e,T);return(0,R.jsx)(S.Z,n()(n()({footer:null,width:"auto",centered:!0,style:n()({maxWidth:"80%"},o)},a),{},{children:(0,R.jsx)("img",{alt:"",style:{width:"100%"},src:r})}))},N=a.memo(O),z=["onUpload","fileTypeMessage","fileSizeMessage","maxSize","maxCount","onGetPreviewUrl","dragger","icon","title","previewModalProps","accept","className","disabled","action","beforeUpload"],_=function(e){var t=e.onUpload,r=e.fileTypeMessage,i=void 0===r?"只支持上传 %s 文件":r,o=e.fileSizeMessage,s=void 0===o?"必须小于 %s！":o,u=e.maxSize,d=void 0===u?2097152:u,p=e.maxCount,f=e.onGetPreviewUrl,m=e.dragger,x=void 0!==m&&m,b=(e.icon,e.title,e.previewModalProps),S=e.accept,T=e.className,O=e.disabled,_=e.action,G=e.beforeUpload,I=l()(e,z),q=a.useMemo((function(){return(0,M.Z)("__am_itemUpload_")}),[]),A=a.useRef(!1),E=(0,y.Z)({open:!1,title:"",imgUrl:""}),F=h()(E,2),D=F[0],H=F[1],V=a.useCallback((function(e,r){var n=function(e,t){if(!t||!t.trim()||"*"===t)return!0;var r=t.toLowerCase().split(/,(?:\s+)?/),i=!1;return r.some((function(t){if(e.type===t||0===t.indexOf(".")&&e.name.toLowerCase().substring(e.name.length-t.length)===t)i=!0;else if(t.includes("/*")&&e.type.includes("/")){var r=t.match(/(.*)\/\*/),n=e.type.split("/")[0];r&&r[1]===n&&(i=!0)}return i})),i}(e,S);if(!n)return!1!==i&&w.ZP.error(i.replace(/%s/g,S)),j.Z.LIST_IGNORE;var o=function(e,t){return e.size<t}(e,d);if(!o){var l=(0,L.Z)(d);return!1!==s&&w.ZP.error(s.replace(/%s/g,l)),j.Z.LIST_IGNORE}return G?G(e,r):!!_||!!t||!(null==I||!I.customRequest)}),[S,d,G,_,t,null==I?void 0:I.customRequest,i,s]),W=a.useCallback((function(e){var r=null;!function i(){A.current?r=setTimeout(i,100):(A.current=!0,clearTimeout(r),setTimeout((function(){var r;null===(r=e.onProgress)||void 0===r||r.call(e,{percent:99}),null==t||t(e.file).then(e.onSuccess).catch(e.onError).finally((function(){A.current=!1}))})))}()}),[t]),B=a.useMemo((function(){return null==I||!I.showUploadList||"object"!==c()(I.showUploadList)||!1!==I.showUploadList.showPreviewIcon}),[null==I?void 0:I.showUploadList]),J=a.useCallback(function(){var e=g()(v()().mark((function e(t){return v()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:if(!f||t.preview){e.next=8;break}return e.next=5,f((null==t?void 0:t.originFileObj)||t);case 5:t.preview=e.sent,e.next=9;break;case 8:t.url||(t.url=k(q,t.uid,(null==t?void 0:t.originFileObj)||t));case 9:if(t.preview||t.url||t.thumbUrl){e.next=12;break}return w.ZP.error("当前文件不支持预览！"),e.abrupt("return");case 12:H({open:!0,imgUrl:t.preview||t.url||t.thumbUrl,title:t.name||Z(t.url)});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[B,f,H,q]),K=a.useCallback((function(){H({open:!1})}),[H]),Q=a.useMemo((function(){return x?j.Z.Dragger:j.Z}),[x]);return(0,P.Z)((function(){var e,t;C[e=q]&&(t?(C[e][t]&&URL.revokeObjectURL(C[e][t]),delete C[e][t]):(Object.keys(C[e]).forEach((function(t){URL.revokeObjectURL(C[e][t])})),delete C[e]))})),(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(Q,n()({accept:S,beforeUpload:V,customRequest:_?void 0:W,onPreview:J,disabled:O,className:U()("antd-more-form-upload",T),action:_,maxCount:p},I)),B&&!I.onPreview&&(0,R.jsx)(N,n()(n()(n()({},D),b),{},{onCancel:K}))]})},G=["showUploadList","icon","title"],I={showPreviewIcon:!1},q=function(e){var t=e.showUploadList,r=e.icon,i=void 0===r?(0,R.jsx)(p.Z,{}):r,o=e.title,s=void 0===o?"点击上传":o,u=l()(e,G),f=a.useMemo((function(){return("boolean"!=typeof t||!1!==t)&&("object"===c()(t)?n()(n()({},I),t):I)}),[t]);return(0,R.jsx)(_,n()(n()({},u),{},{showUploadList:f,children:(0,R.jsx)(d.ZP,{icon:i,children:s})}))},A=r(36882),E=r(68928),F=function(e){var t=e.loading,r=void 0!==t&&t,i=e.uploading,n=void 0!==i&&i,o=e.icon,l=void 0===o?(0,R.jsx)(A.Z,{}):o,s=e.title,u=void 0===s?"点击上传":s,c=a.useMemo((function(){return r?"加载中":n?"上传中":u}),[r,u,n]);return(0,R.jsxs)("div",{children:[r||n?(0,R.jsx)(E.Z,{}):l,(0,R.jsx)("div",{style:{marginTop:8,lineHeight:1.5},children:c})]})},D=["fileList","maxCount","icon","title"],H=function(e){var t=e.fileList,r=e.maxCount,i=e.icon,o=e.title,a=l()(e,D);return(0,R.jsx)(_,n()(n()({fileList:t,maxCount:r,listType:"picture-card"},a),{},{accept:(null==a?void 0:a.accept)||".jpg, .jpeg, .png",children:r&&t&&t.length>=r?null:(0,R.jsx)(F,{icon:i,title:o})}))},V=r(40448),W=r.n(V),B=r(68341),J=r(9788),K=["fileList","className","icon","title"],Q="antd-more-form-upload-avatar",X=function(e){var t=e.fileList,r=e.icon,i=e.title,n=a.useState(""),o=h()(n,2),l=o[0],s=o[1],u=a.useMemo((function(){return Array.isArray(t)&&t.length>0?t[0]:null}),[t]),c="uploading"===(null==u?void 0:u.status);a.useEffect((function(){u&&(u.thumbUrl||u.url||u.preview||(u.preview=URL.createObjectURL((null==u?void 0:u.originFileObj)||u)),s(u.thumbUrl||u.url||u.preview))}),[u]);var d=null;d=u&&"error"===u.status?(0,R.jsxs)("div",{style:{width:"100%"},children:[(0,R.jsx)(J.Z,{}),(0,R.jsx)("div",{style:{marginTop:8,padding:"0 8px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:u.name||"",children:u.name||""})]}):c||!l?(0,R.jsx)(F,{uploading:c,icon:r,title:i}):(0,R.jsx)("img",{src:l,alt:u&&u.name||""});var p=(0,R.jsx)("div",{className:U()("".concat(Q,"-box"),W()({},"".concat(Q,"-box-error"),u&&"error"===u.status)),children:d});return u&&"error"===u.status&&u.response?(0,R.jsx)(B.Z,{title:u.response,children:p}):p},Y=function(e){var t=e.fileList,r=e.className,i=e.icon,o=e.title,a=l()(e,K);return(0,R.jsx)(_,n()(n()({},a),{},{listType:"picture-card",accept:(null==a?void 0:a.accept)||".jpg, .jpeg, .png",fileList:t,showUploadList:!1,multiple:!1,maxCount:1,className:U()(Q,r),children:(0,R.jsx)(X,{fileList:t,icon:i,title:o})}))},$=r(48675),ee=["showUploadList","icon","title"],te={showPreviewIcon:!1},re=function(e){var t=e.showUploadList,r=e.icon,i=void 0===r?(0,R.jsx)($.Z,{}):r,o=e.title,s=void 0===o?"单击或拖动文件到此区域进行上传":o,u=l()(e,ee),d=a.useMemo((function(){return("boolean"!=typeof t||!1!==t)&&("object"===c()(t)?n()(n()({},te),t):te)}),[t]);return(0,R.jsxs)(_,n()(n()({},u),{},{dragger:!0,showUploadList:d,children:[(0,R.jsx)("p",{className:"ant-upload-drag-icon",children:i}),(0,R.jsx)("p",{className:"ant-upload-text",children:s})]}))},ie=r(40563),ne=["name","uploadProps","accept","onUpload","onGetPreviewUrl","fileTypeMessage","fileSizeMessage","maxSize","maxCount","type","disabled","multiple","icon","title","previewModalProps","required","transform"],oe=function(e){return Array.isArray(e)?e:e&&e.fileList},le=function(e){var t=e.name,r=e.uploadProps,i=e.accept,o=e.onUpload,u=e.onGetPreviewUrl,c=e.fileTypeMessage,d=e.fileSizeMessage,p=e.maxSize,f=e.maxCount,v=e.type,m=void 0===v?"default":v,g=e.disabled,x=void 0!==g&&g,h=e.multiple,w=void 0!==h&&h,j=e.icon,b=e.title,U=e.previewModalProps,L=e.required,y=e.transform,P=l()(e,ne),M=a.useMemo((function(){return"image"===m?H:"avatar"===m?Y:"dragger"===m?re:q}),[m]);return(0,R.jsx)(s.Z,n()(n()({required:L,valuePropName:"fileList",getValueFromEvent:oe,transform:y,name:t,rules:[{validator:function(e,t){var r="",i=t&&"function"==typeof y?y(t):t;return(!i||Array.isArray(i)&&i.length<=0)&&(r=L?"请上传".concat((0,ie.Z)(P)):""),r?Promise.reject(r):Promise.resolve()}}]},P),{},{children:(0,R.jsx)(M,n()({accept:i,onUpload:o,onGetPreviewUrl:u,fileTypeMessage:c,fileSizeMessage:d,maxSize:p,maxCount:f,disabled:x,multiple:w,icon:j,title:b,previewModalProps:U},r))}))};le.Preview=N;var ae=le}}]);